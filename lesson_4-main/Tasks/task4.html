<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Lesson 4 :: Task 4</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="css/normalize.css" />
    <link rel="stylesheet" href="css/style.css" />
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css"
      integrity="sha384-HSMxcRTRxnN+Bdg0JdbxYKrThecOKuH5zCYotlSAcp1+c8xmyTe9GYg1l9a69psu"
      crossorigin="anonymous"
    />
  </head>
  <body>
    <div class="container">
      <div class="row">
        <div class="col-md-3">
          <h3>Form 1</h3>
          <form id="first_form">
            <label>
              <input class="form-control" name="title" />
            </label>

            <div class="checkbox">
              <label>
                <input
                  class="_checkbox"
                  type="checkbox"
                  name="first_form_checkbox[]"
                />
                One
              </label>
            </div>
            <div class="checkbox">
              <label>
                <input
                  class="_checkbox"
                  type="checkbox"
                  name="first_form_checkbox[]"
                />
                Two
              </label>
            </div>
            <div class="checkbox">
              <label>
                <input
                  class="_checkbox"
                  type="checkbox"
                  name="first_form_checkbox[]"
                />
                Three
              </label>
            </div>
            <div class="checkbox">
              <label>
                <input
                  class="_checkbox"
                  type="checkbox"
                  name="first_form_checkbox[]"
                />
                Four
              </label>
            </div>
            <div class="checkbox">
              <label>
                <input
                  class="_checkbox"
                  type="checkbox"
                  name="first_form_checkbox[]"
                />
                Five
              </label>
            </div>
            <button type="submit" class="btn btn-success">Send</button>
          </form>
        </div>

        <div class="col-md-3">
          <h3>Form 2</h3>
          <form id="second_form">
            <label>
              <input class="form-control" name="title" />
            </label>

            <div class="checkbox">
              <label>
                <input
                  class="_checkbox"
                  type="checkbox"
                  name="second_form_checkbox_one[]"
                />
                One
              </label>
            </div>
            <div class="checkbox">
              <label>
                <input
                  class="_checkbox"
                  type="checkbox"
                  name="second_form_checkbox_one[]"
                />
                Two
              </label>
            </div>
            <div class="checkbox">
              <label>
                <input
                  class="_checkbox"
                  type="checkbox"
                  name="second_form_checkbox_one[]"
                />
                Three
              </label>
            </div>
            <div class="checkbox">
              <label>
                <input
                  class="_checkbox"
                  type="checkbox"
                  name="second_form_checkbox_one[]"
                />
                Four
              </label>
            </div>
            <div class="checkbox">
              <label>
                <input
                  class="_checkbox"
                  type="checkbox"
                  name="second_form_checkbox_one[]"
                />
                Five
              </label>
            </div>

            <b> Checkbox 2</b>

            <div class="checkbox">
              <label>
                <input
                  class="_checkbox"
                  type="checkbox"
                  name="second_form_checkbox_two[]"
                />
                One
              </label>
            </div>
            <div class="checkbox">
              <label>
                <input
                  class="_checkbox"
                  type="checkbox"
                  name="second_form_checkbox_two[]"
                />
                Two
              </label>
            </div>
            <div class="checkbox">
              <label>
                <input
                  class="_checkbox"
                  type="checkbox"
                  name="second_form_checkbox_two[]"
                />
                Three
              </label>
            </div>
            <div class="checkbox">
              <label>
                <input
                  class="_checkbox"
                  type="checkbox"
                  name="second_form_checkbox_two[]"
                />
                Four
              </label>
            </div>
            <div class="checkbox">
              <label>
                <input
                  class="_checkbox"
                  type="checkbox"
                  name="second_form_checkbox_two[]"
                />
                Five
              </label>
            </div>

            <button type="submit" class="btn btn-success">Send</button>
          </form>
        </div>

        <div class="col-md-3">
          <h3>Form 3</h3>
          <form id="third_form">
            <label>
              <input class="form-control" name="title" />
            </label>

            <div class="checkbox">
              <label>
                <input
                  class="_checkbox"
                  type="checkbox"
                  name="third_form_checkbox[]"
                />
                One
              </label>
            </div>
            <div class="checkbox">
              <label>
                <input
                  class="_checkbox"
                  type="checkbox"
                  name="third_form_checkbox[]"
                />
                Two
              </label>
            </div>
            <div class="checkbox">
              <label>
                <input
                  class="_checkbox"
                  type="checkbox"
                  name="third_form_checkbox[]"
                />
                Three
              </label>
            </div>
            <div class="checkbox">
              <label>
                <input
                  class="_checkbox"
                  type="checkbox"
                  name="third_form_checkbox[]"
                />
                Four
              </label>
            </div>
            <div class="checkbox">
              <label>
                <input
                  class="_checkbox"
                  type="checkbox"
                  name="third_form_checkbox[]"
                />
                Five
              </label>
            </div>
            <button type="submit" class="btn btn-success">Send</button>
          </form>
        </div>

        <div class="col-md-3">
          <h3>Form 4</h3>
          <form id="fourth_form">
            <label>
              <input class="form-control" name="title" />
            </label>

            <div class="checkbox">
              <label>
                <input
                  class="_checkbox"
                  type="checkbox"
                  name="fourth_form_checkbox[]"
                />
                One
              </label>
            </div>
            <div class="checkbox">
              <label>
                <input
                  class="_checkbox"
                  type="checkbox"
                  name="fourth_form_checkbox[]"
                />
                Two
              </label>
            </div>
            <div class="checkbox">
              <label>
                <input
                  class="_checkbox"
                  type="checkbox"
                  name="fourth_form_checkbox[]"
                />
                Three
              </label>
            </div>
            <div class="checkbox">
              <label>
                <input
                  class="_checkbox"
                  type="checkbox"
                  name="fourth_form_checkbox[]"
                />
                Four
              </label>
            </div>
            <div class="checkbox">
              <label>
                <input
                  class="_checkbox"
                  type="checkbox"
                  name="fourth_form_checkbox[]"
                />
                Five
              </label>
            </div>
            <button type="submit" class="btn btn-success">Send</button>
          </form>
        </div>
      </div>
    </div>

    <script>
      /*
            Задание 4.


            1) Нужно написать функцию которая будет находить чекбоксы внутри формы
            и добавлять лимиты на количество элементов, которые могут быть выбраны внутри этой формы.

            Вызов должен выглядеть так:

            formCheckboxLimit( form_id, checkbox_name, limits );

            В результате внутри выбранной формы {form_id}, чекбоксы с указанным именем {checkbox_name} не должны выбираться больше чем
            количество указанное в {limits}.

            2) Нужно написать функцию, которая будет делать те же самые лимиты, что и в задании 1.
            Но инициализация этого функционала должна проходить не явно, а по наличию класса на чекбоксе.

            Т.е например мы находим все элементы формы которые имеют определенный класс и делаем проверку,
            которая не будет позволять выбрать больше чем {2} элемента с одинаковым неймом.

        */

      const firstForm = document.getElementById("first_form");
      const secondForm = document.getElementById("second_form");
      const thirdForm = document.getElementById("third_form");
      const fourthForm = document.getElementById("fourth_form");

      const formCheckboxLimit = (form_id, checkbox_name, limits) => {
        let checkBoxes = form_id.querySelectorAll(`[name='${checkbox_name}']`);
        checkBoxes.forEach((element) => {
          element.addEventListener("change", () => {
            let checkedCheckBoxes = form_id.querySelectorAll(`[name='${checkbox_name}']:checked`);
            if (Array.from(checkedCheckBoxes).length > limits) {
              element.checked = false;
            }
          });
        });
      };

      formCheckboxLimit(firstForm, "first_form_checkbox[]", 3);

      const formCheckboxLimit2 = (form_id, checkbox_class) => {
        let checkBoxes = form_id.querySelectorAll(`.${checkbox_class}`);
        checkBoxes.forEach((element) => {
          element.addEventListener("change", (event) => {
            let checkedCheckBoxes = form_id.querySelectorAll(`[name='${event.target.name}']:checked`);
            if (Array.from(checkedCheckBoxes).length > 2) {
              element.checked = false;
            }
          });
        });
      };

      formCheckboxLimit2(secondForm,  '_checkbox');

    </script>
  </body>
</html>
